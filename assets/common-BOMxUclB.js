import{j as e}from"./index-CGeEUy5P.js";import{r as n}from"./react-vendor-qWGkjVPF.js";var o={};const t=`${"/EVE-Data-Site/".replace(/\/$/,"")}/data`,r="".replace(/\/$/,"")||t,i=o.VITE_BLOB_PUBLIC_BASE||"",s=(o.VITE_AZURE_BASE||"https://evedatafunc01.azurewebsites.net/api").replace(/\/$/,""),a="https://esi.evetech.net/latest";async function c(e,n={},o=3){for(let r=0;r<o;r++)try{const o=await fetch(e,n);if(!o.ok){await o.text();throw new Error(`HTTP ${o.status}: ${o.statusText}`)}const t=o.headers.get("content-type");if(t&&t.includes("application/json"))return await o.json();await o.text();throw new Error("Response is not JSON")}catch(t){if(r===o-1)throw t;await new Promise(e=>setTimeout(e,1e3*Math.pow(2,r)))}}async function l(e){let n;for(const t of e.filter(Boolean))try{return await c(t)}catch(o){n=o}throw n||new Error("No sources available")}function g(){return l([`${r}/market.json`,`${r}/market/market.json`,i&&`${i}/market/market.json`])}function u(){return l([`${r}/regions.json`,`${r}/regions/regions.json`,i&&`${i}/regions/regions.json`]).then(e=>{if(Array.isArray(e))return e;if(e&&Array.isArray(e.regions))return e.regions;throw new Error("Invalid regions.json format")})}function f(){return l([`${r}/structures.json`,`${r}/structures/structures.json`,i&&`${i}/structures/structures.json`])}function d(){return l([`${r}/stations.json`,`${r}/stations/stations_npc.json`,i&&`${i}/stations/stations_npc.json`])}function m(e,n){const o=String(e),t=String(n||e);try{const e=`${o}-${t}.json`,n=`${s}/log/request?name=${encodeURIComponent(e)}&source=${encodeURIComponent("spa:region_hauling")}`;"undefined"!=typeof navigator&&"function"==typeof navigator.sendBeacon?navigator.sendBeacon(n,"1"):fetch(n,{method:"GET",mode:"no-cors",cache:"no-store",keepalive:!0}).catch(()=>{})}catch{}return l([`${r}/region_hauling/${o}-${t}.json`,`${r}/region-hauling/${o}-${t}.json`,`${r}/region_hauling/${o}_${t}.json`,`${r}/region-hauling/${o}_${t}.json`,`${r}/region_hauling/${o}/${t}.json`,`${r}/region-hauling/${o}/${t}.json`,i&&`${i}/region_hauling/${o}-${t}.json`,i&&`${i}/region-hauling/${o}-${t}.json`])}function h(e){const n=String(e);try{const e=`${n}.json`,o=`${s}/log/request?name=${encodeURIComponent(e)}&source=${encodeURIComponent("spa:region_orders")}`;"undefined"!=typeof navigator&&"function"==typeof navigator.sendBeacon?navigator.sendBeacon(o,"1"):fetch(o,{method:"GET",mode:"no-cors",cache:"no-store",keepalive:!0}).catch(()=>{})}catch{}return l([`${r}/region_orders/${n}.json`,i&&`${i}/region_orders/${n}.json`])}const p=["The Forge","Domain","Heimatar","Sinq Laison","Metropolis"];function $({selectedRegion:o,onRegionChange:t,allowAllRegions:r=!0}){const[i,s]=n.useState([]),[a,c]=n.useState(null),[l,g]=n.useState(!0);n.useEffect(()=>{!async function(){try{const e=await u();if(!e||!Array.isArray(e))throw new Error("Invalid regions data format");const n=19000001,o=e.filter(e=>e.regionID!==n);s(o),c(null),g(!1)}catch(e){c(`Failed to load regions: ${e.message}`),s([]),g(!1)}}()},[]),n.useEffect(()=>{r&&(!o||!o.regionID)&&i.length>0&&t?.({regionName:"All Regions",regionID:"all"})},[o,i,t,r]);const{popularRegionsList:f,otherRegionsList:d,allRegionsList:m}=n.useMemo(()=>({popularRegionsList:i.filter(e=>p.includes(e.regionName)).sort((e,n)=>e.regionName.localeCompare(n.regionName)),otherRegionsList:i.filter(e=>!p.includes(e.regionName)).sort((e,n)=>e.regionName.localeCompare(n.regionName)),allRegionsList:i.slice().sort((e,n)=>e.regionName.localeCompare(n.regionName))}),[i]);if(a)return e.jsxs("div",{style:{color:"red",padding:"1rem"},children:["Error loading regions: ",a]});if(0===i.length){const n=l?"Loading regions...":"Discovering regions from market data...";return e.jsx("div",{style:{padding:"1rem"},children:n})}return e.jsx("div",{className:"region-selector-container",children:e.jsxs("select",{className:"region-selector",id:"region-select",value:o?.regionID||(r?"all":""),onChange:e=>{const n=e.target.value;if(!n)return void t?.(null);if("all"===n)return void t?.({regionName:"All Regions",regionID:"all"});const o=i.find(e=>String(e.regionID)===n);o&&t?.(o)},children:[!r&&e.jsx("option",{value:"",children:"*Select a Region*"}),r&&e.jsx("option",{value:"all",children:"All Regions"}),f.length>0&&e.jsx("optgroup",{label:"Popular Regions",children:f.map(n=>e.jsx("option",{value:n.regionID,children:n.regionName},n.regionID))}),e.jsx("optgroup",{label:"All Regions (Alphabetical)",children:m.map(n=>e.jsx("option",{value:n.regionID,children:n.regionName},`all-${n.regionID}`))})]})})}const j=e=>Math.floor(10*e)/10,v=e=>e?.split(" ").map(e=>e[0].toUpperCase()+e.slice(1)).join(" ")??"",y=e=>`${e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})} ISK`,w=e=>`${Math.floor(e/1440)}d ${Math.floor(e%1440/60)}h ${e%60}m`,R=e=>{const n=parseInt(e,10);if(-1===n)return"Station";if(0===n)return"System";if(32767===n)return"Region";if(!isNaN(n))return`${n} ${1===n?"Jump":"Jumps"}`;const o=String(e).trim().toLowerCase();return["station","system","region"].includes(o)?v(o):v(e)},I=e=>{const n=[[1,"#2e74df"],[.9,"#389cf6"],[.8,"#4acff3"],[.7,"#62daa6"],[.6,"#71e452"],[.5,"#eeff83"],[.4,"#de6a0c"],[.3,"#ce4611"],[.2,"#bb1014"],[.1,"#6d221d"],[0,"#8f2f69"]];for(const[o,t]of n)if(e>=o)return t;return"#8f2f69"},_="none",A="mild",E="moderate",N="strict",S="ultra";function x(e,n=_){if(n===_||e.length<10)return e;const o=[...e].sort((e,n)=>e.price-n.price);let t,r,i;switch(n){case A:t=.05,r=.95,i=1.5;break;case E:t=.1,r=.9,i=1;break;case N:t=.25,r=.75,i=.5;break;case S:t=.375,r=.625,i=.25;break;default:return e}const s=Math.floor(o.length*t),a=Math.floor(o.length*r),c=o[s].price,l=o[a].price,g=l-c,u=Math.max(c,c-i*g),f=l+i*g;return o.filter(e=>e.price>=u&&e.price<=f)}function b(e){const n=[];return function e(o,t=[]){for(const[r,i]of Object.entries(o))if("_info"!==r){if(Array.isArray(i?.items))for(const e of i.items)n.push({...e,categoryPath:[...t,r].join(" > ")});for(const[n,o]of Object.entries(i))"items"!==n&&"_info"!==n&&"object"==typeof o&&e({[n]:o},[...t,r])}}(e),n}export{s as A,a as E,$ as R,w as a,R as b,v as c,x as d,b as e,y as f,I as g,u as h,f as i,d as j,c as k,h as l,m,g as n,j as t};
