import{j as e}from"./index-BVWZRb2-.js";import{r as t}from"./react-vendor-qWGkjVPF.js";const r=`${"/EVE-Data-Site/".replace(/\/$/,"")}/data`,o="".replace(/\/$/,"")||r,n={}.VITE_BLOB_PUBLIC_BASE||"",i="https://evedatafunc01.azurewebsites.net/api",s="https://esi.evetech.net/latest";async function a(e,t={},r=3){for(let n=0;n<r;n++)try{const r=await fetch(e,t);if(!r.ok){await r.text();throw new Error(`HTTP ${r.status}: ${r.statusText}`)}const o=r.headers.get("content-type");if(o&&o.includes("application/json"))return await r.json();await r.text();throw new Error("Response is not JSON")}catch(o){if(n===r-1)throw o;await new Promise(e=>setTimeout(e,1e3*Math.pow(2,n)))}}async function l(e){let t;for(const o of e.filter(Boolean))try{return await a(o)}catch(r){t=r}throw t||new Error("No sources available")}function c(){return l([`${o}/market.json`,`${o}/market/market.json`,n&&`${n}/market/market.json`])}function g(){return l([`${o}/regions.json`,`${o}/regions/regions.json`,n&&`${n}/regions/regions.json`])}function u(){return l([`${o}/structures.json`,`${o}/structures/structures.json`,n&&`${n}/structures/structures.json`])}const f=["The Forge","Domain","Heimatar","Sinq Laison","Metropolis"];function m({selectedRegion:r,onRegionChange:o,allowAllRegions:n=!0}){const[i,s]=t.useState([]),[a,l]=t.useState(null),[c,u]=t.useState(!0);t.useEffect(()=>{!async function(){try{const e=await g();if(!e||!Array.isArray(e))throw new Error("Invalid regions data format");const t=19000001,r=e.filter(e=>e.regionID!==t);s(r),l(null),u(!1)}catch(e){l(`Failed to load regions: ${e.message}`),s([]),u(!1)}}()},[]),t.useEffect(()=>{n&&(!r||!r.regionID)&&i.length>0&&o?.({regionName:"All Regions",regionID:"all"})},[r,i,o,n]);const{popularRegionsList:m,otherRegionsList:d,allRegionsList:p}=t.useMemo(()=>({popularRegionsList:i.filter(e=>f.includes(e.regionName)).sort((e,t)=>e.regionName.localeCompare(t.regionName)),otherRegionsList:i.filter(e=>!f.includes(e.regionName)).sort((e,t)=>e.regionName.localeCompare(t.regionName)),allRegionsList:i.slice().sort((e,t)=>e.regionName.localeCompare(t.regionName))}),[i]);if(a)return e.jsxs("div",{style:{color:"red",padding:"1rem"},children:["Error loading regions: ",a]});if(0===i.length){const t=c?"Loading regions...":"Discovering regions from market data...";return e.jsx("div",{style:{padding:"1rem"},children:t})}return e.jsx("div",{className:"region-selector-container",children:e.jsxs("select",{className:"region-selector",id:"region-select",value:r?.regionID||(n?"all":""),onChange:e=>{const t=e.target.value;if(!t)return void o?.(null);if("all"===t)return void o?.({regionName:"All Regions",regionID:"all"});const r=i.find(e=>String(e.regionID)===t);r&&o?.(r)},children:[!n&&e.jsx("option",{value:"",children:"*Select a Region*"}),n&&e.jsx("option",{value:"all",children:"All Regions"}),m.length>0&&e.jsx("optgroup",{label:"Popular Regions",children:m.map(t=>e.jsx("option",{value:t.regionID,children:t.regionName},t.regionID))}),e.jsx("optgroup",{label:"All Regions (Alphabetical)",children:p.map(t=>e.jsx("option",{value:t.regionID,children:t.regionName},`all-${t.regionID}`))})]})})}const d=e=>Math.floor(10*e)/10,p=e=>e?.split(" ").map(e=>e[0].toUpperCase()+e.slice(1)).join(" ")??"",h=e=>`${e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})} ISK`,j=e=>`${Math.floor(e/1440)}d ${Math.floor(e%1440/60)}h ${e%60}m`,w=e=>{const t=parseInt(e,10);if(-1===t)return"Station";if(0===t)return"System";if(32767===t)return"Region";if(!isNaN(t))return`${t} ${1===t?"Jump":"Jumps"}`;const r=String(e).trim().toLowerCase();return["station","system","region"].includes(r)?p(r):p(e)},$=e=>{const t=[[1,"#2e74df"],[.9,"#389cf6"],[.8,"#4acff3"],[.7,"#62daa6"],[.6,"#71e452"],[.5,"#eeff83"],[.4,"#de6a0c"],[.3,"#ce4611"],[.2,"#bb1014"],[.1,"#6d221d"],[0,"#8f2f69"]];for(const[r,o]of t)if(e>=r)return o;return"#8f2f69"},v="none",N="mild",R="moderate",x="strict",y="ultra";function b(e,t=v){if(t===v||e.length<10)return e;const r=[...e].sort((e,t)=>e.price-t.price);let o,n,i;switch(t){case N:o=.05,n=.95,i=1.5;break;case R:o=.1,n=.9,i=1;break;case x:o=.25,n=.75,i=.5;break;case y:o=.375,n=.625,i=.25;break;default:return e}const s=Math.floor(r.length*o),a=Math.floor(r.length*n),l=r[s].price,c=r[a].price,g=c-l,u=Math.max(l,l-i*g),f=c+i*g;return r.filter(e=>e.price>=u&&e.price<=f)}function D(e){const t=[];return function e(r,o=[]){for(const[n,i]of Object.entries(r))if("_info"!==n){if(Array.isArray(i?.items))for(const e of i.items)t.push({...e,categoryPath:[...o,n].join(" > ")});for(const[t,r]of Object.entries(i))"items"!==t&&"_info"!==t&&"object"==typeof r&&e({[t]:r},[...o,n])}}(e),t}export{i as A,s as E,m as R,j as a,w as b,p as c,b as d,D as e,h as f,$ as g,g as h,u as i,a as j,c as k,d as t};
